<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="命令语法history num 显示指定条数的最新历史记录history num 123456[root@iZbp1191gh7vw52537lyxrZ ~]# history 5  106  root 2022-08-14 10:54:02  ls  107  root 2022-08-14 10:54:07  cat &#x2F;etc&#x2F;bashrc  108  root 2022-08-14 10:5">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/02/06/yunwei/command/history/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="命令语法history num 显示指定条数的最新历史记录history num 123456[root@iZbp1191gh7vw52537lyxrZ ~]# history 5  106  root 2022-08-14 10:54:02  ls  107  root 2022-08-14 10:54:07  cat &#x2F;etc&#x2F;bashrc  108  root 2022-08-14 10:5">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-02-06T07:10:08.095Z">
<meta property="article:modified_time" content="2023-02-06T07:10:08.095Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-yunwei/command/history" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/02/06/yunwei/command/history/" class="article-date">
  <time datetime="2023-02-06T07:10:08.095Z" itemprop="datePublished">2023-02-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="命令语法"><a href="#命令语法" class="headerlink" title="命令语法"></a>命令语法</h2><h3 id="history-num-显示指定条数的最新历史记录"><a href="#history-num-显示指定条数的最新历史记录" class="headerlink" title="history num 显示指定条数的最新历史记录"></a>history num 显示指定条数的最新历史记录</h3><p>history num</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history 5</span><br><span class="line">  106  root 2022-08-14 10:54:02  ls</span><br><span class="line">  107  root 2022-08-14 10:54:07  cat /etc/bashrc</span><br><span class="line">  108  root 2022-08-14 10:54:55  vim ~/.bashrc</span><br><span class="line">  109  root 2022-08-14 10:55:55  man history</span><br><span class="line">  110  root 2022-08-14 10:58:48  history 5</span><br></pre></td></tr></table></figure>



<h3 id="num-重复执行指定记录"><a href="#num-重复执行指定记录" class="headerlink" title="!num 重复执行指定记录"></a>!num 重复执行指定记录</h3><p>计数都是从1开始的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history 5</span><br><span class="line">  113  root 2022-08-14 11:01:48  ls</span><br><span class="line">  114  root 2022-08-14 11:02:02  echo &quot; 1 &quot; &gt; 1.txt</span><br><span class="line">  115  root 2022-08-14 11:02:03  ls</span><br><span class="line">  116  root 2022-08-14 11:02:08  history</span><br><span class="line">  117  root 2022-08-14 11:02:15  history 5</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !115</span><br><span class="line">ls</span><br><span class="line">1.txt</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]#</span><br></pre></td></tr></table></figure>

<h3 id="num-从列表末尾开始计数指定第num行命令"><a href="#num-从列表末尾开始计数指定第num行命令" class="headerlink" title="!-num 从列表末尾开始计数指定第num行命令"></a>!-num 从列表末尾开始计数指定第num行命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history 10</span><br><span class="line">   96  root 2022-08-14 11:02:15  history 5</span><br><span class="line">   97  root 2022-08-14 11:02:26  ls</span><br><span class="line">   98  root 2022-08-14 11:05:46  history 5</span><br><span class="line">   99  root 2022-08-14 11:06:06  history</span><br><span class="line">  100  root 2022-08-14 11:06:20  ls</span><br><span class="line">  101  root 2022-08-14 17:07:36  hi</span><br><span class="line">  102  root 2022-08-14 17:07:41  hitory</span><br><span class="line">  103  root 2022-08-14 17:07:44  history</span><br><span class="line">  104  root 2022-08-14 17:07:59  history 6</span><br><span class="line">  105  root 2022-08-14 17:08:04  history 10</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !-6</span><br><span class="line">ls</span><br><span class="line">1.txt</span><br></pre></td></tr></table></figure>



<h3 id="执行上一条命令"><a href="#执行上一条命令" class="headerlink" title="!! 执行上一条命令"></a>!! 执行上一条命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history 10</span><br><span class="line">   96  root 2022-08-14 11:02:15  history 5</span><br><span class="line">   97  root 2022-08-14 11:02:26  ls</span><br><span class="line">   98  root 2022-08-14 11:05:46  history 5</span><br><span class="line">   99  root 2022-08-14 11:06:06  history</span><br><span class="line">  100  root 2022-08-14 11:06:20  ls</span><br><span class="line">  101  root 2022-08-14 17:07:36  hi</span><br><span class="line">  102  root 2022-08-14 17:07:41  hitory</span><br><span class="line">  103  root 2022-08-14 17:07:44  history</span><br><span class="line">  104  root 2022-08-14 17:07:59  history 6</span><br><span class="line">  105  root 2022-08-14 17:08:04  history 10</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !-6</span><br><span class="line">ls</span><br><span class="line">1.txt</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !!</span><br><span class="line">ls</span><br><span class="line">1.txt</span><br></pre></td></tr></table></figure>



<h3 id="string-执行以某字符串开头的最新命令"><a href="#string-执行以某字符串开头的最新命令" class="headerlink" title="!string 执行以某字符串开头的最新命令"></a>!string 执行以某字符串开头的最新命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history | grep ls</span><br><span class="line">    9  root 2022-08-14 17:07:32  ls ~/.bash_history  -lat</span><br><span class="line">   60  root 2022-08-12 15:49:47  ls</span><br><span class="line">   62  root 2022-08-12 15:50:11  ls</span><br><span class="line">   64  root 2022-08-12 15:56:38   ls</span><br><span class="line">   65  root 2022-08-12 15:56:41  ls</span><br><span class="line">   67  root 2022-08-12 15:56:45  ls</span><br><span class="line">   71  root 2022-08-14 10:41:02  ls</span><br><span class="line">   73  root 2022-08-14 10:41:05  ls</span><br><span class="line">   76  root 2022-08-14 10:41:19  ls</span><br><span class="line">   85  root 2022-08-14 10:54:02  ls</span><br><span class="line">   92  root 2022-08-14 11:01:48  ls</span><br><span class="line">   94  root 2022-08-14 11:02:03  ls</span><br><span class="line">   97  root 2022-08-14 11:02:26  ls</span><br><span class="line">  100  root 2022-08-14 11:06:20  ls</span><br><span class="line">  106  root 2022-08-14 17:08:22  ls</span><br><span class="line">  107  root 2022-08-14 17:11:34  lsls</span><br><span class="line">  108  root 2022-08-14 17:11:46  history | grep ls</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !ls</span><br><span class="line">lsls</span><br><span class="line">-bash: lsls: 未找到命令</span><br></pre></td></tr></table></figure>



<h3 id="string-p-查找以字符串开头的最新命令"><a href="#string-p-查找以字符串开头的最新命令" class="headerlink" title="!string:p 查找以字符串开头的最新命令"></a>!string:p 查找以字符串开头的最新命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !ls:p</span><br><span class="line">lsls</span><br></pre></td></tr></table></figure>



<h3 id="string-执行包含字符串的最新命令"><a href="#string-执行包含字符串的最新命令" class="headerlink" title="!?string 执行包含字符串的最新命令"></a>!?string 执行包含字符串的最新命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history 5</span><br><span class="line">  108  root 2022-08-14 17:11:46  history | grep ls</span><br><span class="line">  109  root 2022-08-14 17:11:55  lsls</span><br><span class="line">  110  root 2022-08-14 17:15:08  pwd aaa</span><br><span class="line">  111  root 2022-08-14 17:15:25  pwd a23</span><br><span class="line">  112  root 2022-08-14 17:15:36  history 5</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# !?a</span><br><span class="line">pwd a23</span><br><span class="line">/root</span><br></pre></td></tr></table></figure>



<h3 id="history-d-num-删除指定行记录"><a href="#history-d-num-删除指定行记录" class="headerlink" title="history -d num 删除指定行记录"></a>history -d num 删除指定行记录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history -d 2</span><br></pre></td></tr></table></figure>



<h3 id="history-c-清空当前用户当前终端历史记录"><a href="#history-c-清空当前用户当前终端历史记录" class="headerlink" title="history -c 清空当前用户当前终端历史记录"></a>history -c 清空当前用户当前终端历史记录</h3><p>历史记录文件.bash_history文件内容是存在的，新开终端，还是会存在之前的历史记录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line"></span><br><span class="line">history</span><br><span class="line">#1660663206</span><br><span class="line">history</span><br><span class="line">ls</span><br><span class="line">cd /</span><br><span class="line">history</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<h3 id="history-a-追加当前终端新的历史记录到历史记录文件"><a href="#history-a-追加当前终端新的历史记录到历史记录文件" class="headerlink" title="history -a 追加当前终端新的历史记录到历史记录文件"></a>history -a 追加当前终端新的历史记录到历史记录文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history</span><br><span class="line">ls test-a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ ls test-b</span><br><span class="line">ls: 无法访问test-b: 权限不够</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history</span><br><span class="line">ls test-a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history -a</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history</span><br><span class="line">ls test-a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">history</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">ls test-b</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br></pre></td></tr></table></figure>

<h3 id="history-w-将整个历史记录写入历史记录文件"><a href="#history-w-将整个历史记录写入历史记录文件" class="headerlink" title="history -w 将整个历史记录写入历史记录文件"></a>history -w 将整个历史记录写入历史记录文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history</span><br><span class="line">ls test-a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">history</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">ls test-b</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ rm -rf ~/.bash_history</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history -a</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history -a</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ rm -rf ~/.bash_history</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history</span><br><span class="line">    1  rm -rf ~/.bash_history</span><br><span class="line">    2  history</span><br><span class="line">    3  ls test-a</span><br><span class="line">    4  cat ~/.bash_history</span><br><span class="line">    5  history -a</span><br><span class="line">    6  history</span><br><span class="line">    7  cat ~/.bash_history</span><br><span class="line">    8  ls test-b</span><br><span class="line">    9  cat ~/.bash_history</span><br><span class="line">   10  history -a</span><br><span class="line">   11  cat ~/.bash_history</span><br><span class="line">   12  rm -rf ~/.bash_history</span><br><span class="line">   13  history -a</span><br><span class="line">   14  cat ~/.bash_history</span><br><span class="line">   15  rm -rf ~/.bash_history</span><br><span class="line">   16  history</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history -w</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history</span><br><span class="line">ls test-a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">history</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">ls test-b</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history -a</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">rm -rf ~/.bash_history</span><br><span class="line">history</span><br><span class="line">history -w</span><br></pre></td></tr></table></figure>

<h3 id="set-o-history-禁止记录历史记录（当前会话生效）"><a href="#set-o-history-禁止记录历史记录（当前会话生效）" class="headerlink" title="set +o history 禁止记录历史记录（当前会话生效）"></a>set +o history 禁止记录历史记录（当前会话生效）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ set +o history</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history</span><br><span class="line">    1  rm -rf ~/.bash_history</span><br><span class="line">    2  history</span><br><span class="line">    3  ls test-a</span><br><span class="line">    4  cat ~/.bash_history</span><br><span class="line">    5  history -a</span><br><span class="line">    6  history</span><br><span class="line">    7  cat ~/.bash_history</span><br><span class="line">    8  ls test-b</span><br><span class="line">    9  cat ~/.bash_history</span><br><span class="line">   10  history -a</span><br><span class="line">   11  cat ~/.bash_history</span><br><span class="line">   12  rm -rf ~/.bash_history</span><br><span class="line">   13  history -a</span><br><span class="line">   14  cat ~/.bash_history</span><br><span class="line">   15  rm -rf ~/.bash_history</span><br><span class="line">   16  history</span><br><span class="line">   17  history -w</span><br><span class="line">   18  cat ~/.bash_history</span><br><span class="line">   19  set +o history</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ ls test+ohistory</span><br><span class="line">ls: 无法访问test+ohistory: 权限不够</span><br><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history</span><br><span class="line">    1  rm -rf ~/.bash_history</span><br><span class="line">    2  history</span><br><span class="line">    3  ls test-a</span><br><span class="line">    4  cat ~/.bash_history</span><br><span class="line">    5  history -a</span><br><span class="line">    6  history</span><br><span class="line">    7  cat ~/.bash_history</span><br><span class="line">    8  ls test-b</span><br><span class="line">    9  cat ~/.bash_history</span><br><span class="line">   10  history -a</span><br><span class="line">   11  cat ~/.bash_history</span><br><span class="line">   12  rm -rf ~/.bash_history</span><br><span class="line">   13  history -a</span><br><span class="line">   14  cat ~/.bash_history</span><br><span class="line">   15  rm -rf ~/.bash_history</span><br><span class="line">   16  history</span><br><span class="line">   17  history -w</span><br><span class="line">   18  cat ~/.bash_history</span><br><span class="line">   19  set +o history</span><br></pre></td></tr></table></figure>



<h3 id="set-o-history-启动记录历史记录（当前会话生效）"><a href="#set-o-history-启动记录历史记录（当前会话生效）" class="headerlink" title="set -o history 启动记录历史记录（当前会话生效）"></a>set -o history 启动记录历史记录（当前会话生效）</h3><h2 id="history配置"><a href="#history配置" class="headerlink" title="history配置"></a>history配置</h2><h3 id="history格式配置"><a href="#history格式配置" class="headerlink" title="history格式配置"></a>history格式配置</h3><h4 id="HISTTIMEFORMAT-增加操作时间"><a href="#HISTTIMEFORMAT-增加操作时间" class="headerlink" title="HISTTIMEFORMAT 增加操作时间"></a>HISTTIMEFORMAT 增加操作时间</h4><p>export HISTTIMEFORMAT=”%F %T “</p>
<p>%d 天</p>
<p>%m 月</p>
<p>%y 年</p>
<p>%H 小时</p>
<p>%M 分钟</p>
<p>%S 秒</p>
<p>%F 日期完整格式 （Y-M-D格式：2022-08-14）</p>
<p>%T 时间完整格式（H:M:S格式：17:15:25）</p>
<p>%c 日期时间完整格式（2022年08月14日 星期日 17时25分30秒）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export HISTTIMEFORMAT=&quot;`whoami` %c  &quot;</span><br></pre></td></tr></table></figure>



<h4 id="HISTSIZE-history命令最大显示记录命令数（也就是执行history命令显示的命令条数）"><a href="#HISTSIZE-history命令最大显示记录命令数（也就是执行history命令显示的命令条数）" class="headerlink" title="HISTSIZE history命令最大显示记录命令数（也就是执行history命令显示的命令条数）"></a>HISTSIZE history命令最大显示记录命令数（也就是执行history命令显示的命令条数）</h4><p>export HISTSIZE = 100</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history | more</span><br><span class="line">   19  root 2022-08-14 17:07:32  history</span><br><span class="line">   20  root 2022-08-14 17:07:32  history</span><br><span class="line">   21  root 2022-08-14 17:07:32  cat /root/.bash_history</span><br><span class="line">   22  root 2022-08-14 17:07:32  cat /etc/passwd</span><br><span class="line">   23  root 2022-08-14 17:07:32  su test</span><br><span class="line">  ......</span><br><span class="line">  112  root 2022-08-14 17:15:36  history 5</span><br><span class="line">  113  root 2022-08-14 17:15:49  pwd a23</span><br><span class="line">  114  root 2022-08-14 17:25:12  vim /etc/bashrc</span><br><span class="line">  115  root 2022-08-14 17:26:29  ls</span><br><span class="line">  116  root 2022-08-14 17:26:35  cat /etc/bashrc</span><br><span class="line">  117  root 2022-08-14 17:27:25  vim /root/.bash_history</span><br><span class="line">  118  root 2022-08-14 17:28:11  history | more</span><br></pre></td></tr></table></figure>

<h4 id="HISTFILESIZE-bash-history文件保存记录最大数"><a href="#HISTFILESIZE-bash-history文件保存记录最大数" class="headerlink" title="HISTFILESIZE .bash_history文件保存记录最大数"></a>HISTFILESIZE .bash_history文件保存记录最大数</h4><p>export HISTFILESIZE=10</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history</span><br><span class="line">    1  root 2022年08月14日 星期日 17时32分30秒  cat ~/.bash_history</span><br><span class="line">    2  root 2022年08月14日 星期日 17时32分49秒  history</span><br><span class="line">    3  root 2022年08月14日 星期日 17时34分05秒  date</span><br><span class="line">    4  root 2022年08月14日 星期日 17时34分38秒  cat ~/.bash_history</span><br><span class="line">    5  root 2022年08月14日 星期日 17时34分42秒  history -w</span><br><span class="line">    6  root 2022年08月14日 星期日 17时36分56秒  cat /root/.bash_history</span><br><span class="line">    7  root 2022年08月14日 星期日 17时47分24秒  pwd</span><br><span class="line">    8  root 2022年08月14日 星期日 17时47分28秒  ls /tmp</span><br><span class="line">    9  root 2022年08月14日 星期日 17时47分34秒  history</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# cat /root/.bash_history</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">#1660469682</span><br><span class="line">history -w</span><br><span class="line">#1660469519</span><br><span class="line">history</span><br><span class="line">#1660469532</span><br><span class="line">vim /root/.bash_history</span><br><span class="line">#1660469550</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">#1660469569</span><br><span class="line">history</span><br><span class="line">#1660469645</span><br><span class="line">date</span><br><span class="line">#1660469678</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">#1660469682</span><br><span class="line">history -w</span><br><span class="line">#1660469684</span><br><span class="line">cat ~/.bash_history</span><br><span class="line">#1660469130</span><br><span class="line">history</span><br></pre></td></tr></table></figure>



<h3 id="history配置文件"><a href="#history配置文件" class="headerlink" title="history配置文件"></a>history配置文件</h3><p>新开终端加载新的配置文件</p>
<h4 id="etc-bashrc-通用配置文件"><a href="#etc-bashrc-通用配置文件" class="headerlink" title="/etc/bashrc 通用配置文件"></a>/etc/bashrc 通用配置文件</h4><p>增加配置后所有用户都会生效</p>
<h4 id="bashrc-各用户独立配置文件，也会加载主配置文件-etc-bashrc"><a href="#bashrc-各用户独立配置文件，也会加载主配置文件-etc-bashrc" class="headerlink" title="~/.bashrc 各用户独立配置文件，也会加载主配置文件/etc/bashrc"></a>~/.bashrc 各用户独立配置文件，也会加载主配置文件/etc/bashrc</h4><p>root默认配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# ls ~/.bashrc -l</span><br><span class="line">-rw-r--r--. 1 root root 176 12月 29 2013 /root/.bashrc</span><br><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# cat ~/.bashrc</span><br><span class="line"># .bashrc</span><br><span class="line"></span><br><span class="line"># User specific aliases and functions</span><br><span class="line"></span><br><span class="line">alias rm=&#x27;rm -i&#x27;</span><br><span class="line">alias cp=&#x27;cp -i&#x27;</span><br><span class="line">alias mv=&#x27;mv -i&#x27;</span><br><span class="line"></span><br><span class="line"># Source global definitions</span><br><span class="line">if [ -f /etc/bashrc ]; then</span><br><span class="line">	. /etc/bashrc</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>



<p>普通用户默认配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bashrc</span><br><span class="line"># .bashrc</span><br><span class="line"></span><br><span class="line"># Source global definitions</span><br><span class="line">if [ -f /etc/bashrc ]; then</span><br><span class="line">	. /etc/bashrc</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># Uncomment the following line if you don&#x27;t like systemctl&#x27;s auto-paging feature:</span><br><span class="line"># export SYSTEMD_PAGER=</span><br><span class="line"></span><br><span class="line"># User specific aliases and functions</span><br></pre></td></tr></table></figure>



<p>配置示例</p>
<p>root</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# cat ~/.bashrc</span><br><span class="line"># .bashrc</span><br><span class="line"></span><br><span class="line"># User specific aliases and functions</span><br><span class="line"></span><br><span class="line">alias rm=&#x27;rm -i&#x27;</span><br><span class="line">alias cp=&#x27;cp -i&#x27;</span><br><span class="line">alias mv=&#x27;mv -i&#x27;</span><br><span class="line"></span><br><span class="line"># Source global definitions</span><br><span class="line">if [ -f /etc/bashrc ]; then</span><br><span class="line">	. /etc/bashrc</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">HISTTIMEFORMAT=&quot;%F &quot;</span><br></pre></td></tr></table></figure>

<p>root history</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp1191gh7vw52537lyxrZ ~]# history</span><br><span class="line">    1  2022-08-16 telnet 27.221.32.84 3317</span><br><span class="line">    2  2022-08-16 telnet 123.125.204.111 6379</span><br><span class="line">    3  2022-08-16 telnet 123.125.204.64 8500</span><br><span class="line">    4  2022-08-16 telnet 123.126.54.207 3389</span><br><span class="line">    5  2022-08-16 telnet 123.125.204.111 6379</span><br><span class="line">    6  2022-08-16 ls</span><br><span class="line">    7  2022-08-16 ls ~/.bashrc</span><br><span class="line">    8  2022-08-16 ls ~/.bashrc -l</span><br><span class="line">    9  2022-08-16 cat ~/.bashrc</span><br><span class="line">   10  2022-08-16 history</span><br><span class="line">   11  2022-08-16 vim /etc/bashrc</span><br><span class="line">   12  2022-08-16 source /etc/bashrc</span><br><span class="line">   13  2022-08-16 history</span><br><span class="line">   14  2022-08-16 source /etc/bashrc</span><br><span class="line">   15  2022-08-16 history</span><br></pre></td></tr></table></figure>



<p>test</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ cat ~/.bashrc</span><br><span class="line"># .bashrc</span><br><span class="line"></span><br><span class="line"># Source global definitions</span><br><span class="line">if [ -f /etc/bashrc ]; then</span><br><span class="line">	. /etc/bashrc</span><br><span class="line">fi</span><br><span class="line">HISTTIMEFORMAT=&quot;%c &quot;</span><br><span class="line"># Uncomment the following line if you don&#x27;t like systemctl&#x27;s auto-paging feature:</span><br><span class="line"># export SYSTEMD_PAGER=</span><br><span class="line"></span><br><span class="line"># User specific aliases and functions</span><br></pre></td></tr></table></figure>

<p>source ~/.bashrc</p>
<p>test history</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[test@iZbp1191gh7vw52537lyxrZ root]$ history</span><br><span class="line">    1  2022年08月16日 星期二 23时09分35秒 history</span><br><span class="line">    2  2022年08月16日 星期二 23时09分35秒 history -w</span><br><span class="line">    3  2022年08月16日 星期二 23时09分35秒 history</span><br><span class="line">    4  2022年08月16日 星期二 23时09分35秒 history -w</span><br><span class="line">    5  2022年08月16日 星期二 23时09分35秒 history</span><br><span class="line">    6  2022年08月16日 星期二 23时09分35秒 ls -lat ~/.bash_history</span><br><span class="line">    7  2022年08月13日 星期六 22时56分56秒 history</span><br><span class="line">    8  2022年08月13日 星期六 22时57分01秒 lll</span><br><span class="line">    9  2022年08月13日 星期六 22时57分03秒 history</span><br><span class="line">   10  2022年08月14日 星期日 10时41分01秒 exit</span><br><span class="line">   11  2022年08月16日 星期二 23时09分35秒 history</span><br><span class="line">   12  2022年08月16日 星期二 23时09分35秒 cat ~/.bashrc</span><br><span class="line">   13  2022年08月16日 星期二 23时09分53秒 vim ~/.bashrc</span><br><span class="line">   14  2022年08月16日 星期二 23时10分59秒 source ~/.bashrc</span><br><span class="line">   15  2022年08月16日 星期二 23时11分01秒 history</span><br><span class="line">   16  2022年08月16日 星期二 23时11分27秒 cat ~/.bashrc</span><br><span class="line">   17  2022年08月16日 星期二 23时12分14秒 vim ~/.bashrc</span><br><span class="line">   18  2022年08月16日 星期二 23时12分28秒 source ~/.bashrc</span><br><span class="line">   19  2022年08月16日 星期二 23时12分42秒 history</span><br></pre></td></tr></table></figure>



<p>默认情况下，</p>
<p>配置文件示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export HISTTIMEFORMAT=&quot;`whoami` %c  &quot;</span><br><span class="line"></span><br><span class="line">export HISTSIZE=100</span><br><span class="line"></span><br><span class="line">export HISTFILESIZE=10</span><br></pre></td></tr></table></figure>



<h2 id="关注点"><a href="#关注点" class="headerlink" title="关注点"></a>关注点</h2><p>1、默认情况下退出终端（会话）后，会将历史记录写入～/.bash_history文件</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/02/06/yunwei/command/history/" data-id="cldsh4gps0000x2l4hff46akr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2023/02/06/blog/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">blog</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/02/06/yunwei/command/history/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/02/06/blog/">blog</a>
          </li>
        
          <li>
            <a href="/2023/02/06/github-test/">github test</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>